!function(){function e(){y.height=window.innerHeight,y.width=window.innerWidth,A=y.width/k,C=y.height/H,q=y.width/50,L=y.width/25,P.x=L-A*P.width,U.x=y.width-L,P.y=y.height/2-P.height*C/2,U.y=y.height/2-P.height*C/2,N.x=y.width/2,N.y=y.height/2,N.vy=4}function t(e){e.y=e.y<=q?q:e.y+e.height*C>=C*H-q?C*H-q-e.height*C:e.y}function n(){N.x+=A*N.vx*v,N.y+=C*N.vy*v,N.y<=q/2?(N.vy=-N.vy,N.y=q/2):N.y>=y.height-q/2-N.height*A&&(N.vy=-N.vy,N.y=y.height-q/2-N.height*A),N.x<=q/2?(f.fillStyle="grey",U.score++,f.textBaseline="hanging",f.textAlign="center",U.score<j?f.fillText(U.isHuman?"Score: P2":"Score: CPU",y.width/2,q+y.height/4):f.fillText(U.isHuman?"Winner: P1!":"Winner: CPU!",y.width/2,q+y.height/4),f.textAlign="start",f.textBaseline="alphabetic",h()):N.x>=y.width-q/2-N.width*A&&(f.fillStyle="grey",P.score++,f.textBaseline="hanging",f.textAlign="center",P.score<j?f.fillText(P.isHuman?"Score: P1":"Score: CPU",y.width/2,q+y.height/4):f.fillText(P.isHuman?"Winner: P1!":"Winner: CPU!",y.width/2,q+y.height/4),f.textAlign="start",f.textBaseline="alphabetic",h()),a(N,P)?(N.vx=-N.vx,N.vy=i(P),N.x=P.x+P.width*A):a(N,U)&&(N.vx=-N.vx,N.vy=i(U),N.x=U.x-N.width*A)}function i(e){var t=e.y+e.height*C/2-(N.y+N.height*A/2),n=Math.abs(t)/(e.height*C/2)*N.vyMax;return t<=0?n:-n}function h(){x=!0,N.x=y.width/2,N.y=y.height/2,N.vy=o(0,1)>.5?o(1,4):-o(1,4),N.vx=o(0,1)>.5?4:-4,g=cancelAnimationFrame(s),setTimeout(function(){x=!1,g=requestAnimationFrame(s),(P.score>=j||U.score>=j)&&function(e){r(b+"Ui"),b=e||this.dataset.screen,r(b+"Ui"),"gameScreen"===b&&c()}("titleScreen")},1e3)}function a(e,t){return t.x+A*t.width>=e.x&&t.x<=e.x+A*e.width&&t.y+C*t.height>=e.y&&t.y<=e.y+C*e.height}function r(e){document.getElementById(e)&&document.getElementById(e).classList.toggle("js-hidden")}function o(e,t){return Math.random()*(t-e)+e}function c(){P.score=0,U.score=0,e()}function l(){r(b+"Ui"),r((b=this.dataset.screen)+"Ui"),"gameScreen"===b&&c()}function u(){P.isHuman=!1,U.isHuman=!1;for(var e=0;e<=parseInt(this.dataset.players);e++)1===e?P.isHuman=!0:2===e&&(U.isHuman=!0);document.querySelectorAll(".player-select-button").forEach(function(e){e.classList.remove("pong-selected")}),this.classList.add("pong-selected")}function d(){!function(){for(var e=0;e<=H;e++)f.moveTo(y.width/2,E(H-e+.25)),f.lineTo(y.width/2,E(H-e+.75)),f.stroke()}(),function(){if(!U.isHuman){if(N.vx<0)return I=!1,void(O=!1);if((S+=v)>=w){S=0;var e=N.y+N.height*A/2;e<U.y?(I=!1,O=!0):e>U.y+U.height*C&&(I=!0,O=!1)}}}(),function(){if(!P.isHuman){if(N.vx>0)return W=!1,void(F=!1);if((T+=v)>=p){T=0;var e=N.y+N.height*A/2;e<P.y?(W=!1,F=!0):e>P.y+P.height*C&&(W=!0,F=!1)}}}(),P.y+=W?C*P.vy*v:F?-C*P.vy*v:0,U.y+=I?C*U.vy*v:O?-C*U.vy*v:0,t(P),t(U),D.forEach(function(e){f.beginPath(),f.lineWidth=1,f.fillStyle="white",f.strokeStyle="white",f.rect(e.x,e.y,e.width*A,e.height*C),f.stroke(),f.fill()}),n(),f.beginPath(),f.fillStyle=M,f.rect(N.x,N.y,N.width*A,N.height*A),f.fill(),f.fillStyle=M,f.textBaseline="hanging",f.font="bold 14vmin Arial Black",f.textAlign="end",f.fillText(P.score,y.width/2-q,q/2),f.textAlign="start",f.fillText(U.score,y.width/2+q,q/2),f.textBaseline="alphabetic"}function s(e){f.clearRect(0,0,y.width,y.height),f.fillStyle="rgba(22, 22, 22, 1)",f.rect(0,0,y.width,y.height),f.fill(),f.textBaseline="hanging",f.lineWidth=q,f.strokeStyle=M,f.beginPath(),f.moveTo(0,0),f.lineTo(y.width,0),f.stroke(),f.moveTo(0,y.height),f.lineTo(y.width,y.height),f.stroke(),function(e){v=e-m<250?(e-m)/1e3:.0167,m=e}(e),B[b](),x||(g=requestAnimationFrame(s))}var g,y=document.getElementById("pongCanvas"),f=y.getContext("2d"),m=(Math.PI,0),v=0,x=!1,w=0,S=0,p=.1,T=0,k=16,H=9,A=0,C=0,E=function(e){return y.height-e*C},B={titleScreen:function(){},gameScreen:function(){return d()},settingsScreen:function(){},howToScreen:function(){},pauseScreen:function(){return pauseScreen()},gameOverScreen:function(){}},b="titleScreen",L=y.width/25,P={player:1,x:L,y:0,score:0,width:.25,height:2,vy:4,isHuman:!0},U={player:2,x:y.width-L,y:0,score:0,width:.25,height:2,vy:4,isHuman:!1},D=[P,U],N={x:y.width/2,y:y.height/2,width:.35,height:.35,vx:4,vy:4,vxMin:1,vxMax:8,vyMax:6},q=y.width/50,M="rgba(222, 222, 222, 1)",W=!1,F=!1,I=!1,O=!1,j=10;e(),g=requestAnimationFrame(s),document.querySelectorAll(".change-screen-button").forEach(function(e){e.addEventListener("click",l)}),window.addEventListener("resize",function(){cancelAnimationFrame(g),e(),g=requestAnimationFrame(s)}),document.addEventListener("keydown",function(e){"gameScreen"===b&&(38===e.keyCode&&P.isHuman?(e.preventDefault(),F=!0):40===e.keyCode&&P.isHuman?(e.preventDefault(),W=!0):83===e.keyCode&&U.isHuman?I=!0:87===e.keyCode&&U.isHuman?O=!0:80===e.keyCode&&pause())}),document.addEventListener("keyup",function(e){"gameScreen"===b&&(38===e.keyCode&&P.isHuman?(e.preventDefault(),F=!1):40===e.keyCode&&P.isHuman?(e.preventDefault(),W=!1):83===e.keyCode&&U.isHuman?I=!1:87===e.keyCode&&U.isHuman?O=!1:80===e.keyCode&&pause())}),document.querySelectorAll(".player-select-button").forEach(function(e){e.addEventListener("click",u)}),y.addEventListener("touchstart",function(e){"BUTTON"!==e.target.nodeName&&e.preventDefault(),"gameScreen"===b&&(e.touches[0].clientY<=y.height/2?F=!0:W=!0)},!0),y.addEventListener("touchend",function(e){"BUTTON"!==e.target.nodeName&&e.preventDefault(),"gameScreen"===b&&(W=!1,F=!1)},!0),y.addEventListener("mousedown",function(e){"BUTTON"!==e.target.nodeName&&e.preventDefault(),"gameScreen"===b&&(e.y<=y.height/2?F=!0:W=!0)},!0),y.addEventListener("mouseup",function(e){"BUTTON"!==e.target.nodeName&&e.preventDefault(),"gameScreen"===b&&(W=!1,F=!1)},!0)}();