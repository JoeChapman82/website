!function(){function e(){y.height=window.innerHeight-document.getElementById("mainNavigation").getBoundingClientRect().height,y.width=window.innerWidth,E=y.width/H,A=y.height/C,W=y.width/50,L=y.width/25,P.x=L-E*P.width,U.x=y.width-L,P.y=y.height/2-P.height*A/2,U.y=y.height/2-P.height*A/2,M.x=y.width/2,M.y=y.height/2,M.vy=4}function t(e){e.y=e.y<=W?W:e.y+e.height*A>=A*C-W?A*C-W-e.height*A:e.y}function i(){M.x+=E*M.vx*v,M.y+=A*M.vy*v,M.y<=W/2?(M.vy=-M.vy,M.y=W/2):M.y>=y.height-W/2-M.height*E&&(M.vy=-M.vy,M.y=y.height-W/2-M.height*E),M.x<=W/2?(f.fillStyle="grey",U.score++,f.textBaseline="hanging",f.textAlign="center",U.score<z?f.fillText(U.isHuman?"Score: P2":"Score: CPU",y.width/2,W+y.height/4):f.fillText(U.isHuman?"Winner: P1!":"Winner: CPU!",y.width/2,W+y.height/4),f.textAlign="start",f.textBaseline="alphabetic",h()):M.x>=y.width-W/2-M.width*E&&(f.fillStyle="grey",P.score++,f.textBaseline="hanging",f.textAlign="center",P.score<z?f.fillText(P.isHuman?"Score: P1":"Score: CPU",y.width/2,W+y.height/4):f.fillText(P.isHuman?"Winner: P1!":"Winner: CPU!",y.width/2,W+y.height/4),f.textAlign="start",f.textBaseline="alphabetic",h()),o(M,P)?(M.vx=-M.vx,M.vy=n(P),M.x=P.x+P.width*E):o(M,U)&&(M.vx=-M.vx,M.vy=n(U),M.x=U.x-M.width*E)}function n(e){var t=e.y+e.height*A/2-(M.y+M.height*E/2),i=Math.abs(t)/(e.height*A/2)*M.vyMax;return t<=0?i:-i}function h(){x=!0,M.x=y.width/2,M.y=y.height/2,M.vy=r(0,1)>.5?r(1,4):-r(1,4),M.vx=r(0,1)>.5?4:-4,g=cancelAnimationFrame(s),setTimeout(function(){x=!1,g=requestAnimationFrame(s),(P.score>=z||U.score>=z)&&function(e){a(B+"Ui"),B=e||this.dataset.screen,a(B+"Ui"),"gameScreen"===B&&c()}("titleScreen")},1e3)}function o(e,t){return t.x+E*t.width>=e.x&&t.x<=e.x+E*e.width&&t.y+A*t.height>=e.y&&t.y<=e.y+A*e.height}function a(e){document.getElementById(e)&&document.getElementById(e).classList.toggle("js-hidden")}function r(e,t){return Math.random()*(t-e)+e}function c(){P.score=0,U.score=0,e()}function u(){a(B+"Ui"),a((B=this.dataset.screen)+"Ui"),"gameScreen"===B&&c()}function d(){P.isHuman=!1,U.isHuman=!1;for(var e=0;e<=parseInt(this.dataset.players);e++)1===e?P.isHuman=!0:2===e&&(U.isHuman=!0);document.querySelectorAll(".player-select-button").forEach(function(e){e.classList.remove("pong-selected")}),this.classList.add("pong-selected")}function l(){!function(){for(var e=0;e<=C;e++)f.moveTo(y.width/2,T(C-e+.25)),f.lineTo(y.width/2,T(C-e+.75)),f.stroke()}(),function(){if(!U.isHuman){if(M.vx<0)return R=!1,void(j=!1);if((S+=v)>=w){S=0;var e=M.y+M.height*E/2;e<U.y?(R=!1,j=!0):e>U.y+U.height*A&&(R=!0,j=!1)}}}(),function(){if(!P.isHuman){if(M.vx>0)return I=!1,void(D=!1);if((k+=v)>=p){k=0;var e=M.y+M.height*E/2;e<P.y?(I=!1,D=!0):e>P.y+P.height*A&&(I=!0,D=!1)}}}(),P.y+=I?A*P.vy*v:D?-A*P.vy*v:0,U.y+=R?A*U.vy*v:j?-A*U.vy*v:0,t(P),t(U),q.forEach(function(e){f.beginPath(),f.lineWidth=1,f.fillStyle="white",f.strokeStyle="white",f.rect(e.x,e.y,e.width*E,e.height*A),f.stroke(),f.fill()}),i(),f.beginPath(),f.fillStyle=F,f.rect(M.x,M.y,M.width*E,M.height*E),f.fill(),f.fillStyle=F,f.textBaseline="hanging",f.font="bold 14vmin Arial Black",f.textAlign="end",f.fillText(P.score,y.width/2-W,W/2),f.textAlign="start",f.fillText(U.score,y.width/2+W,W/2),f.textBaseline="alphabetic"}function s(e){f.clearRect(0,0,y.width,y.height),f.fillStyle="rgba(22, 22, 22, 1)",f.rect(0,0,y.width,y.height),f.fill(),f.textBaseline="hanging",f.lineWidth=W,f.strokeStyle=F,f.beginPath(),f.moveTo(0,0),f.lineTo(y.width,0),f.stroke(),f.moveTo(0,y.height),f.lineTo(y.width,y.height),f.stroke(),function(e){v=e-m<250?(e-m)/1e3:.0167,m=e}(e),b[B](),x||(g=requestAnimationFrame(s))}var g,y=document.getElementById("pongCanvas"),f=y.getContext("2d"),m=(Math.PI,0),v=0,x=!1,w=0,S=0,p=.1,k=0,H=16,C=9,E=0,A=0,T=function(e){return y.height-e*A},b={titleScreen:function(){},gameScreen:function(){return l()},settingsScreen:function(){},howToScreen:function(){},pauseScreen:function(){return pauseScreen()},gameOverScreen:function(){}},B="titleScreen",L=y.width/25,P={player:1,x:L,y:0,score:0,width:.25,height:2,vy:4,isHuman:!0},U={player:2,x:y.width-L,y:0,score:0,width:.25,height:2,vy:4,isHuman:!1},q=[P,U],M={x:y.width/2,y:y.height/2,width:.35,height:.35,vx:4,vy:4,vxMin:1,vxMax:8,vyMax:6},W=y.width/50,F="rgba(222, 222, 222, 1)",I=!1,D=!1,R=!1,j=!1,z=10;e(),g=requestAnimationFrame(s),document.querySelectorAll(".change-screen-button").forEach(function(e){e.addEventListener("click",u)}),window.addEventListener("resize",function(){cancelAnimationFrame(g),e(),g=requestAnimationFrame(s)}),document.addEventListener("keydown",function(e){"gameScreen"===B&&(38===e.keyCode&&P.isHuman?(e.preventDefault(),D=!0):40===e.keyCode&&P.isHuman?(e.preventDefault(),I=!0):83===e.keyCode&&U.isHuman?R=!0:87===e.keyCode&&U.isHuman?j=!0:80===e.keyCode&&pause())}),document.addEventListener("keyup",function(e){"gameScreen"===B&&(38===e.keyCode&&P.isHuman?(e.preventDefault(),D=!1):40===e.keyCode&&P.isHuman?(e.preventDefault(),I=!1):83===e.keyCode&&U.isHuman?R=!1:87===e.keyCode&&U.isHuman?j=!1:80===e.keyCode&&pause())}),document.querySelectorAll(".player-select-button").forEach(function(e){e.addEventListener("click",d)}),document.addEventListener("touchstart",function(e){"gameScreen"===B&&(e.touches[0].clientY<=y.height/2?D=!0:I=!0)}),document.addEventListener("touchend",function(e){"gameScreen"===B&&(I=!1,D=!1)}),document.addEventListener("mousedown",function(e){"gameScreen"===B&&(e.y<=y.height/2?D=!0:I=!0)}),document.addEventListener("mouseup",function(e){"gameScreen"===B&&(I=!1,D=!1)})}();