function setup(){canvas.height=window.innerHeight,canvas.width=window.innerWidth,horizontalUnit=canvas.width/worldWidth,worldHeight=canvas.height/ww(1),verticalUnit=canvas.height/worldHeight,snake.width=ww(.5),snake.height=ww(.5)}function setDeltaTime(e){deltaTime=(e-lastTime)/1e3,lastTime=e}function clearCanvas(){ctx.clearRect(0,0,canvas.width,canvas.height)}function renderBackground(){ctx.fillStyle="rgba(22, 22, 22, 1)",ctx.rect(0,0,canvas.width,canvas.height),ctx.fill()}function showHideUiElements(e){document.getElementById(e)&&document.getElementById(e).classList.toggle("js-hidden")}function randomNumber(e,t){return Math.random()*(t-e)+e}function startGame(){setup(),isAlive=!0,hasMoved=!1,clicksMade=0,snake.length=1,snake.direction="right",snake.x=0,snake.y=ww(4),snake.body=[],score=0,snake.bodyLength=5,movementTime="hard"===difficulty?.05:"medium"===difficulty?.1:.2,spawnApple()}function spawnApple(){apples.length=0;var e=!0,t=new Apple(ww(Math.round(randomNumber(0,worldWidth-.5))),ww(Math.round(randomNumber(0,worldHeight-.5))));isCollidingRectRect(t,snake)&&(e=!1);for(var n=0;n<snake.body.length;n++)isCollidingRectRect(t,snake.body[n])&&(e=!1);e?apples.push(t):spawnApple()}function updateSnake(){if(movementTimer+=deltaTime,isAlive&&movementTimer>=movementTime){switch(snake.hasChangedDirection=!0,movementTimer=0,snake.body.push(new SnakeBody(snake.x,snake.y)),snake.direction){case"right":snake.x+=snake.width;break;case"left":snake.x-=snake.width;break;case"up":snake.y-=snake.height;break;case"down":snake.y+=snake.height}isCollidingRectRect(snake,apples[0])&&(score+=apples[0].score,snake.bodyLength++,spawnApple()),isPassedWorldsEnd(snake)&&(isAlive=!1,changeGivenScreen("gameOverScreen"));for(var e=0;e<snake.body.length;e++)isCollidingRectRect(snake,snake.body[e])&&(isAlive=!1,changeGivenScreen("gameOverScreen"));snake.body.length>snake.bodyLength&&snake.body.shift()}}function renderSnake(){isAlive&&(ctx.beginPath(),ctx.fillStyle="green",ctx.strokeStyle="green",ctx.lineWidth=2,ctx.rect(snake.x,snake.y,snake.width,snake.height),ctx.fill(),ctx.stroke(),snake.body.forEach(function(e){ctx.beginPath(),ctx.fillStyle="lightgreen",ctx.strokeStyle="green",ctx.lineWidth=2,ctx.rect(e.x,e.y,e.width,e.height),ctx.rect(e.x+e.width/4,e.y+e.height/4,e.width/2,e.height/2),ctx.moveTo(e.x+e.width/4,e.y+e.height/4),ctx.lineTo(e.x+e.width-e.width/4,e.y+e.height-e.height/4),ctx.moveTo(e.x+e.width-e.width/4,e.y+e.height/4),ctx.lineTo(e.x+e.width/4,e.y+e.height-e.height/4),ctx.fill(),ctx.stroke()}))}function updateApples(){apples.forEach(function(e){e.scoreTimer+=deltaTime,e.scoreTimer>=e.scoreTime&&(e.score--,e.scoreTimer=0,0===e.score&&spawnApple())})}function renderApples(){apples.forEach(function(e){var t=ctx.createRadialGradient(e.x+e.width/2,e.y+e.height/2,e.width/2,e.x+e.width/2,e.y+e.height/2,0);ctx.beginPath(),ctx.strokeStyle="darkred",ctx.lineWidth=2,t.addColorStop(0,"darkred"),t.addColorStop(1,"red"),ctx.fillStyle=t,ctx.arc(e.x+e.width/2,e.y+e.height/2,e.width/2,0,twoPi),ctx.fill(),ctx.stroke(),ctx.beginPath(),ctx.strokeStyle="#8B4513",ctx.lineWidth=5,ctx.moveTo(e.x+e.width/2,e.y),ctx.lineTo(e.x+e.width/2,e.y-10),ctx.stroke(),ctx.font="14px Arial",ctx.textAlign="center",ctx.fillStyle="white",ctx.fillText(e.score,e.x+e.width/2,e.y+e.height/2+3)})}function renderScore(){ctx.beginPath(),ctx.textBaseline="top",ctx.font="6vmin Comic Sans MS",ctx.textAlign="center",ctx.fillStyle="green",ctx.fillText("Score: "+score,canvas.width/2,0),ctx.textBaseline="alphabetic"}function renderGameOver(){ctx.beginPath(),ctx.font="10vmin Comic Sans MS",ctx.textAlign="center",ctx.fillStyle="green",ctx.fillText("GAME OVER :(",canvas.width/2,canvas.height/3)}function isCollidingRectRect(e,t){return e.x===t.x&&e.y===t.y}function isPassedWorldsEnd(e){return e.x<0||e.x>ww(worldWidth-.5)||e.y<ww(0)||e.y+e.height>ww(worldHeight+.5)}function changeScreen(){showHideUiElements(activeScreen+"Ui"),showHideUiElements((activeScreen=this.dataset.screen)+"Ui"),"gameScreen"===activeScreen&&startGame()}function changeGivenScreen(e){showHideUiElements(activeScreen+"Ui"),showHideUiElements((activeScreen=e||this.dataset.screen)+"Ui"),"gameScreen"===activeScreen&&startGame()}function changeDifficulty(){difficulty=difficulties.includes(this.dataset.difficulty)?this.dataset.difficulty:"easy"}function titleScreen(){}function settingsScreen(){}function howToScreen(){}function gameScreen(){updateApples(),renderApples(),updateSnake(),renderSnake(),renderScore()}function gameOverScreen(){renderScore(),renderGameOver()}function main(e){clearCanvas(),renderBackground(),setDeltaTime(e),screens[activeScreen](),animation=requestAnimationFrame(main)}var animation,canvas=document.getElementById("snakeCanvas"),ctx=canvas.getContext("2d"),twoPi=2*Math.PI,lastTime=0,deltaTime=0,clicksMade=0;console.log("hithere you");var snake={x:0,y:0,width:25,height:25,direction:"right",bodyLength:5,body:[],hasChangedDirection:!0},SnakeBody=function(e,t){this.x=e,this.y=t,this.width=ww(.5),this.height=ww(.5)},score=0,difficulty="easy",difficulties=["easy","medium","hard"],directions=["right","down","left","up"],isAlive=!1,movementTimer=0,movementTime="hard"===difficulty?.5:"medium"===difficulty?.1:.2,Apple=function(e,t){this.x=e,this.y=t,this.width=ww(.5),this.height=ww(.5),this.score=10,this.scoreTimer=0,this.scoreTime="hard"===difficulty?.5:"medium"===difficulty?.75:1},apples=[],worldWidth=16,worldHeight=9,horizontalUnit=0,verticalUnit=0,ww=function(e){return e*horizontalUnit},wh=function(e){return canvas.height-e*verticalUnit},screens={titleScreen:function(){return titleScreen()},gameScreen:function(){return gameScreen()},settingsScreen:function(){return settingsScreen()},howToScreen:function(){return howToScreen()},pauseScreen:function(){return pauseScreen()},gameOverScreen:function(){return gameOverScreen()}},activeScreen="titleScreen";setup(),animation=requestAnimationFrame(main),document.querySelectorAll(".change-screen-button").forEach(function(e){e.addEventListener("click",changeScreen)}),document.querySelectorAll(".change-difficulty-button").forEach(function(e){e.addEventListener("click",changeDifficulty)}),window.addEventListener("resize",function(){cancelAnimationFrame(animation),setup(),animation=requestAnimationFrame(main)}),document.addEventListener("keydown",function(e){"gameScreen"===activeScreen&&isAlive&&(39===e.keyCode&&"left"!==snake.direction&&snake.hasChangedDirection?(snake.direction="right",snake.hasChangedDirection=!1):37===e.keyCode&&"right"!==snake.direction&&snake.hasChangedDirection?(snake.direction="left",snake.hasChangedDirection=!1):38===e.keyCode&&"down"!==snake.direction&&snake.hasChangedDirection?(e.preventDefault(),snake.direction="up",snake.hasChangedDirection=!1):40===e.keyCode&&"up"!==snake.direction&&snake.hasChangedDirection?(e.preventDefault(),snake.direction="down",snake.hasChangedDirection=!1):80===e.keyCode&&pause())}),document.addEventListener("click",function(e){isAlive&&snake.hasChangedDirection&&++clicksMade>1&&(snake.direction=e.x>canvas.width/2?directions[(directions.indexOf(snake.direction)+1)%directions.length]:directions[(directions.indexOf(snake.direction)+3)%directions.length],snake.hasChangedDirection=!1)});